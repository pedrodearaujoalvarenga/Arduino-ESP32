from re import X
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt
import scipy.optimize as spopt
import scipy.fftpack as spfft
import scipy.ndimage as spimg
import cvxpy as cvx

# generate some data with noise
x = np.sort(np.random.uniform(0, 10, 15))
y = 3 + 0.2 * x + 0.1 * np.random.randn(len(x))

# find L1 line fit
l1_fit = lambda x0, x, y: np.sum(np.abs(x0[0] * x + x0[1] - y))
xopt1 = spopt.fmin(func=l1_fit, x0=[1, 1], args=(x, y))

# find L2 line fit
l2_fit = lambda x0, x, y: np.sum(np.power(x0[0] * x + x0[1] - y, 2))
xopt2 = spopt.fmin(func=l2_fit, x0=[1, 1], args=(x, y))

y2 = y.copy()
y2[3] += 4
y2[13] -= 3

# refit the lines
xopt12 = spopt.fmin(func=l1_fit, x0=[1, 1], args=(x, y2))
xopt22 = spopt.fmin(func=l2_fit, x0=[1, 1], args=(x, y2))

# sum of two sinusoids
n = 1024
t = np.linspace(0, 1/8, n)
y = [-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.115000000000000,
-0.140000000000000,
-0.140000000000000,
-0.155000000000000,
-0.145000000000000,
-0.130000000000000,
-0.110000000000000,
-0.125000000000000,
-0.125000000000000,
-0.130000000000000,
-0.125000000000000,
-0.100000000000000,
-0.0750000000000000,
-0.0750000000000000,
-0.0700000000000000,
-0.0750000000000000,
-0.0700000000000000,
-0.0600000000000000,
-0.0250000000000000,
-0.0200000000000000,
-0.00500000000000000,
0.00500000000000000,
0.0500000000000000,
0.115000000000000,
0.160000000000000,
0.170000000000000,
0.175000000000000,
0.165000000000000,
0.170000000000000,
0.150000000000000,
0.185000000000000,
0.135000000000000,
0.105000000000000,
0.0800000000000000,
0.0650000000000000,
0.0600000000000000,
0.0600000000000000,
0.0150000000000000,
-0.0250000000000000,
-0.0700000000000000,
-0.0900000000000000,
-0.120000000000000,
-0.130000000000000,
-0.120000000000000,
-0.150000000000000,
-0.170000000000000,
-0.175000000000000,
-0.165000000000000,
-0.145000000000000,
-0.155000000000000,
-0.160000000000000,
-0.160000000000000,
-0.150000000000000,
-0.140000000000000,
-0.120000000000000,
-0.140000000000000,
-0.155000000000000,
-0.155000000000000,
-0.135000000000000,
-0.130000000000000,
-0.110000000000000,
-0.105000000000000,
-0.130000000000000,
-0.140000000000000,
-0.140000000000000,
-0.140000000000000,
-0.100000000000000,
0.0200000000000000,
0.180000000000000,
0.380000000000000,
0.605000000000000,
0.790000000000000,
0.895000000000000,
0.840000000000000,
0.590000000000000,
0.225000000000000,
-0.0550000000000000,
-0.185000000000000,
-0.190000000000000,
-0.195000000000000,
-0.160000000000000,
-0.135000000000000,
-0.125000000000000,
-0.100000000000000,
-0.100000000000000,
-0.120000000000000,
-0.135000000000000,
-0.155000000000000,
-0.150000000000000,
-0.125000000000000,
-0.105000000000000,
-0.100000000000000,
-0.115000000000000,
-0.125000000000000,
-0.120000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.105000000000000,
-0.115000000000000,
-0.120000000000000,
-0.110000000000000,
-0.105000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.110000000000000,
-0.105000000000000,
-0.0900000000000000,
-0.0850000000000000,
-0.0900000000000000,
-0.115000000000000,
-0.105000000000000,
-0.0900000000000000,
-0.0850000000000000,
-0.0850000000000000,
-0.0850000000000000,
-0.0900000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.0800000000000000,
-0.0600000000000000,
-0.0750000000000000,
-0.0800000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.0700000000000000,
-0.0550000000000000,
-0.0700000000000000,
-0.0850000000000000,
-0.0800000000000000,
-0.0850000000000000,
-0.0550000000000000,
-0.0400000000000000,
-0.0500000000000000,
-0.0650000000000000,
-0.0600000000000000,
-0.0650000000000000,
-0.0500000000000000,
-0.0350000000000000,
-0.0450000000000000,
-0.0450000000000000,
-0.0450000000000000,
-0.0450000000000000,
-0.0300000000000000,
-0.0350000000000000,
-0.0200000000000000,
-0.0400000000000000,
-0.0500000000000000,
-0.0550000000000000,
-0.0300000000000000,
-0.0250000000000000,
-0.0300000000000000,
-0.0550000000000000,
-0.0550000000000000,
-0.0500000000000000,
-0.0400000000000000,
-0.0400000000000000,
-0.0500000000000000,
-0.0650000000000000,
-0.0850000000000000,
-0.0800000000000000,
-0.0800000000000000,
-0.0700000000000000,
-0.0700000000000000,
-0.0800000000000000,
-0.0900000000000000,
-0.0900000000000000,
-0.0950000000000000,
-0.0900000000000000,
-0.0900000000000000,
-0.115000000000000,
-0.135000000000000,
-0.115000000000000,
-0.105000000000000,
-0.100000000000000,
-0.110000000000000,
-0.125000000000000,
-0.140000000000000,
-0.140000000000000,
-0.120000000000000,
-0.115000000000000,
-0.130000000000000,
-0.135000000000000,
-0.150000000000000,
-0.145000000000000,
-0.130000000000000,
-0.130000000000000,
-0.145000000000000,
-0.150000000000000,
-0.160000000000000,
-0.150000000000000,
-0.130000000000000,
-0.125000000000000,
-0.125000000000000,
-0.155000000000000,
-0.155000000000000,
-0.155000000000000,
-0.140000000000000,
-0.125000000000000,
-0.130000000000000,
-0.135000000000000,
-0.150000000000000,
-0.155000000000000,
-0.135000000000000,
-0.130000000000000,
-0.135000000000000,
-0.140000000000000,
-0.165000000000000,
-0.150000000000000,
-0.135000000000000,
-0.125000000000000,
-0.145000000000000,
-0.150000000000000,
-0.160000000000000,
-0.155000000000000,
-0.135000000000000,
-0.140000000000000,
-0.150000000000000,
-0.145000000000000,
-0.160000000000000,
-0.155000000000000,
-0.150000000000000,
-0.130000000000000,
-0.125000000000000,
-0.145000000000000,
-0.150000000000000,
-0.145000000000000,
-0.135000000000000,
-0.120000000000000,
-0.130000000000000,
-0.130000000000000,
-0.150000000000000,
-0.130000000000000,
-0.125000000000000,
-0.110000000000000,
-0.120000000000000,
-0.135000000000000,
-0.140000000000000,
-0.130000000000000,
-0.115000000000000,
-0.105000000000000,
-0.110000000000000,
-0.115000000000000,
-0.125000000000000,
-0.125000000000000,
-0.105000000000000,
-0.100000000000000,
-0.105000000000000,
-0.110000000000000,
-0.120000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0800000000000000,
-0.0850000000000000,
-0.120000000000000,
-0.110000000000000,
-0.105000000000000,
-0.105000000000000,
-0.0900000000000000,
-0.0850000000000000,
-0.105000000000000,
-0.120000000000000,
-0.105000000000000,
-0.105000000000000,
-0.0900000000000000,
-0.0900000000000000,
-0.115000000000000,
-0.130000000000000,
-0.110000000000000,
-0.0950000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.120000000000000,
-0.100000000000000,
-0.0900000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.105000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0900000000000000,
-0.0700000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.0900000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.125000000000000,
-0.0900000000000000,
-0.0700000000000000,
-0.0550000000000000,
-0.0600000000000000,
-0.0450000000000000,
-0.0550000000000000,
-0.0500000000000000,
-0.0200000000000000,
-0.00500000000000000,
0,
0.0200000000000000,
0.0200000000000000,
0.0500000000000000,
0.115000000000000,
0.175000000000000,
0.200000000000000,
0.200000000000000,
0.180000000000000,
0.200000000000000,
0.205000000000000,
0.190000000000000,
0.145000000000000,
0.115000000000000,
0.0950000000000000,
0.0750000000000000,
0.0700000000000000,
0.0650000000000000,
0.0200000000000000,
-0.0200000000000000,
-0.0750000000000000,
-0.0850000000000000,
-0.105000000000000,
-0.100000000000000,
-0.120000000000000,
-0.160000000000000,
-0.160000000000000,
-0.155000000000000,
-0.145000000000000,
-0.130000000000000,
-0.145000000000000,
-0.155000000000000,
-0.150000000000000,
-0.145000000000000,
-0.135000000000000,
-0.115000000000000,
-0.120000000000000,
-0.115000000000000,
-0.125000000000000,
-0.130000000000000,
-0.115000000000000,
-0.105000000000000,
-0.100000000000000,
-0.115000000000000,
-0.155000000000000,
-0.140000000000000,
-0.0400000000000000,
0.140000000000000,
0.365000000000000,
0.570000000000000,
0.735000000000000,
0.805000000000000,
0.725000000000000,
0.465000000000000,
0.150000000000000,
-0.0750000000000000,
-0.175000000000000,
-0.175000000000000,
-0.140000000000000,
-0.110000000000000,
-0.105000000000000,
-0.135000000000000,
-0.155000000000000,
-0.160000000000000,
-0.130000000000000,
-0.120000000000000,
-0.120000000000000,
-0.140000000000000,
-0.150000000000000,
-0.160000000000000,
-0.140000000000000,
-0.120000000000000,
-0.125000000000000,
-0.135000000000000,
-0.160000000000000,
-0.155000000000000,
-0.125000000000000,
-0.110000000000000,
-0.120000000000000,
-0.130000000000000,
-0.120000000000000,
-0.105000000000000,
-0.100000000000000,
-0.0750000000000000,
-0.0750000000000000,
-0.0800000000000000,
-0.0950000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.0550000000000000,
-0.0550000000000000,
-0.0750000000000000,
-0.0700000000000000,
-0.0750000000000000,
-0.0800000000000000,
-0.0700000000000000,
-0.0850000000000000,
-0.100000000000000,
-0.110000000000000,
-0.100000000000000,
-0.115000000000000,
-0.0850000000000000,
-0.0850000000000000,
-0.105000000000000,
-0.110000000000000,
-0.120000000000000,
-0.120000000000000,
-0.105000000000000,
-0.115000000000000,
-0.120000000000000,
-0.135000000000000,
-0.105000000000000,
-0.100000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.115000000000000,
-0.115000000000000,
-0.120000000000000,
-0.110000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.105000000000000,
-0.120000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0850000000000000,
-0.105000000000000,
-0.120000000000000,
-0.125000000000000,
-0.120000000000000,
-0.130000000000000,
-0.115000000000000,
-0.125000000000000,
-0.150000000000000,
-0.175000000000000,
-0.170000000000000,
-0.140000000000000,
-0.145000000000000,
-0.155000000000000,
-0.175000000000000,
-0.185000000000000,
-0.205000000000000,
-0.210000000000000,
-0.190000000000000,
-0.200000000000000,
-0.210000000000000,
-0.220000000000000,
-0.230000000000000,
-0.210000000000000,
-0.190000000000000,
-0.195000000000000,
-0.210000000000000,
-0.240000000000000,
-0.235000000000000,
-0.235000000000000,
-0.210000000000000,
-0.220000000000000,
-0.225000000000000,
-0.245000000000000,
-0.235000000000000,
-0.225000000000000,
-0.220000000000000,
-0.235000000000000,
-0.245000000000000,
-0.260000000000000,
-0.255000000000000,
-0.245000000000000,
-0.230000000000000,
-0.230000000000000,
-0.250000000000000,
-0.270000000000000,
-0.250000000000000,
-0.250000000000000,
-0.260000000000000,
-0.260000000000000,
-0.275000000000000,
-0.290000000000000,
-0.285000000000000,
-0.265000000000000,
-0.260000000000000,
-0.255000000000000,
-0.265000000000000,
-0.275000000000000,
-0.265000000000000,
-0.270000000000000,
-0.265000000000000,
-0.255000000000000,
-0.265000000000000,
-0.280000000000000,
-0.265000000000000,
-0.265000000000000,
-0.250000000000000,
-0.260000000000000,
-0.270000000000000,
-0.270000000000000,
-0.255000000000000,
-0.245000000000000,
-0.225000000000000,
-0.225000000000000,
-0.260000000000000,
-0.265000000000000,
-0.260000000000000,
-0.255000000000000,
-0.245000000000000,
-0.235000000000000,
-0.270000000000000,
-0.250000000000000,
-0.250000000000000,
-0.225000000000000,
-0.225000000000000,
-0.225000000000000,
-0.235000000000000,
-0.245000000000000,
-0.240000000000000,
-0.230000000000000,
-0.225000000000000,
-0.235000000000000,
-0.240000000000000,
-0.250000000000000,
-0.245000000000000,
-0.245000000000000,
-0.190000000000000,
-0.215000000000000,
-0.215000000000000,
-0.235000000000000,
-0.225000000000000,
-0.225000000000000,
-0.220000000000000,
-0.200000000000000,
-0.220000000000000,
-0.230000000000000,
-0.235000000000000,
-0.220000000000000,
-0.205000000000000,
-0.205000000000000,
-0.195000000000000,
-0.230000000000000,
-0.205000000000000,
-0.200000000000000,
-0.190000000000000,
-0.195000000000000,
-0.215000000000000,
-0.215000000000000,
-0.200000000000000,
-0.190000000000000,
-0.170000000000000,
-0.175000000000000,
-0.185000000000000,
-0.210000000000000,
-0.190000000000000,
-0.185000000000000,
-0.185000000000000,
-0.190000000000000,
-0.185000000000000,
-0.200000000000000,
-0.200000000000000,
-0.180000000000000,
-0.180000000000000,
-0.175000000000000,
-0.200000000000000,
-0.195000000000000,
-0.200000000000000,
-0.190000000000000,
-0.190000000000000,
-0.175000000000000,
-0.180000000000000,
-0.200000000000000,
-0.195000000000000,
-0.165000000000000,
-0.155000000000000,
-0.175000000000000,
-0.195000000000000,
-0.195000000000000,
-0.185000000000000,
-0.165000000000000,
-0.150000000000000,
-0.145000000000000,
-0.150000000000000,
-0.170000000000000,
-0.150000000000000,
-0.135000000000000,
-0.105000000000000,
-0.110000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0800000000000000,
-0.0550000000000000,
-0.0150000000000000,
0,
0.0200000000000000,
0.0300000000000000,
0.0550000000000000,
0.0650000000000000,
0.0900000000000000,
0.0900000000000000,
0.0650000000000000,
0.0450000000000000,
0.0500000000000000,
0.0300000000000000,
0.0300000000000000,
-0.0100000000000000,
-0.0250000000000000,
-0.0500000000000000,
-0.0700000000000000,
-0.0900000000000000,
-0.0900000000000000,
-0.145000000000000,
-0.175000000000000,
-0.185000000000000,
-0.205000000000000,
-0.205000000000000,
-0.200000000000000,
-0.200000000000000,
-0.200000000000000,
-0.210000000000000,
-0.215000000000000,
-0.200000000000000,
-0.190000000000000,
-0.190000000000000,
-0.195000000000000,
-0.205000000000000,
-0.185000000000000,
-0.180000000000000,
-0.170000000000000,
-0.165000000000000,
-0.180000000000000,
-0.190000000000000,
-0.195000000000000,
-0.210000000000000,
-0.230000000000000,
-0.215000000000000,
-0.145000000000000,
-0.00500000000000000,
0.190000000000000,
0.415000000000000,
0.615000000000000,
0.695000000000000,
0.580000000000000,
0.275000000000000,
-0.0200000000000000,
-0.195000000000000,
-0.260000000000000,
-0.250000000000000,
-0.245000000000000,
-0.205000000000000,
-0.165000000000000,
-0.155000000000000,
-0.140000000000000,
-0.155000000000000,
-0.180000000000000,
-0.195000000000000,
-0.190000000000000,
-0.185000000000000,
-0.165000000000000,
-0.190000000000000,
-0.180000000000000,
-0.200000000000000,
-0.185000000000000,
-0.175000000000000,
-0.170000000000000,
-0.175000000000000,
-0.175000000000000,
-0.180000000000000,
-0.160000000000000,
-0.160000000000000,
-0.150000000000000,
-0.150000000000000,
-0.155000000000000,
-0.160000000000000,
-0.155000000000000,
-0.145000000000000,
-0.125000000000000,
-0.135000000000000,
-0.150000000000000,
-0.155000000000000,
-0.150000000000000,
-0.135000000000000,
-0.120000000000000,
-0.120000000000000,
-0.130000000000000,
-0.145000000000000,
-0.130000000000000,
-0.125000000000000,
-0.120000000000000,
-0.115000000000000,
-0.125000000000000,
-0.145000000000000,
-0.135000000000000,
-0.130000000000000,
-0.110000000000000,
-0.115000000000000,
-0.110000000000000,
-0.135000000000000,
-0.130000000000000,
-0.105000000000000,
-0.0900000000000000,
-0.100000000000000,
-0.110000000000000,
-0.125000000000000,
-0.100000000000000,
-0.0900000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.0850000000000000,
-0.0800000000000000,
-0.0800000000000000,
-0.110000000000000,
-0.135000000000000,
-0.120000000000000,
-0.120000000000000,
-0.105000000000000,
-0.115000000000000,
-0.135000000000000,
-0.145000000000000,
-0.160000000000000,
-0.135000000000000,
-0.140000000000000,
-0.160000000000000,
-0.165000000000000,
-0.185000000000000,
-0.170000000000000,
-0.160000000000000,
-0.150000000000000,
-0.160000000000000,
-0.155000000000000,
-0.175000000000000,
-0.175000000000000,
-0.150000000000000,
-0.145000000000000,
-0.155000000000000,
-0.155000000000000,
-0.180000000000000,
-0.160000000000000,
-0.165000000000000,
-0.150000000000000,
-0.155000000000000,
-0.170000000000000,
-0.185000000000000,
-0.170000000000000,
-0.170000000000000,
-0.160000000000000,
-0.165000000000000,
-0.180000000000000,
-0.190000000000000,
-0.185000000000000,
-0.155000000000000,
-0.155000000000000,
-0.175000000000000,
-0.190000000000000,
-0.190000000000000,
-0.180000000000000,
-0.175000000000000,
-0.160000000000000,
-0.160000000000000,
-0.185000000000000,
-0.185000000000000,
-0.195000000000000,
-0.170000000000000,
-0.170000000000000,
-0.175000000000000,
-0.185000000000000,
-0.185000000000000,
-0.185000000000000,
-0.170000000000000,
-0.155000000000000,
-0.165000000000000,
-0.170000000000000,
-0.190000000000000,
-0.180000000000000,
-0.170000000000000,
-0.160000000000000,
-0.155000000000000,
-0.175000000000000,
-0.180000000000000,
-0.180000000000000,
-0.155000000000000,
-0.160000000000000,
-0.160000000000000,
-0.165000000000000,
-0.165000000000000,
-0.155000000000000,
-0.150000000000000,
-0.125000000000000,
-0.130000000000000,
-0.155000000000000,
-0.170000000000000,
-0.165000000000000,
-0.150000000000000,
-0.130000000000000,
-0.145000000000000,
-0.155000000000000,
-0.170000000000000,
-0.160000000000000,
-0.155000000000000,
-0.145000000000000,
-0.145000000000000,
-0.170000000000000,
-0.165000000000000,
-0.150000000000000,
-0.145000000000000,
-0.140000000000000,
-0.145000000000000,
-0.155000000000000,
-0.175000000000000,
-0.160000000000000,
-0.140000000000000,
-0.115000000000000,
-0.135000000000000,
-0.150000000000000,
-0.150000000000000,
-0.150000000000000,
-0.125000000000000,
-0.115000000000000,
-0.115000000000000,
-0.130000000000000,
-0.150000000000000,
-0.140000000000000,
-0.140000000000000,
-0.120000000000000,
-0.115000000000000,
-0.115000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0700000000000000,
-0.0500000000000000,
-0.0450000000000000,
-0.0400000000000000,
-0.0600000000000000,
-0.0400000000000000,
-0.00500000000000000,
0.0550000000000000,
0.110000000000000,
0.140000000000000,
0.155000000000000,
0.160000000000000,
0.150000000000000,
0.170000000000000,
0.160000000000000,
0.125000000000000,
0.0950000000000000,
0.0800000000000000,
0.0650000000000000,
0.0850000000000000,
0.0650000000000000,
0.0200000000000000,
-0.0250000000000000,
-0.0700000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.130000000000000,
-0.165000000000000,
-0.175000000000000,
-0.185000000000000,
-0.165000000000000,
-0.150000000000000,
-0.155000000000000,
-0.175000000000000,
-0.180000000000000,
-0.160000000000000,
-0.170000000000000,
-0.140000000000000,
-0.130000000000000,
-0.145000000000000,
-0.160000000000000,
-0.160000000000000,
-0.160000000000000,
-0.160000000000000,
-0.145000000000000,
-0.0650000000000000,
0.115000000000000,
0.360000000000000,
0.575000000000000,
0.735000000000000,
0.795000000000000,
0.760000000000000,
0.560000000000000,
0.310000000000000,
0.0500000000000000,
-0.120000000000000,
-0.215000000000000,
-0.245000000000000,
-0.230000000000000,
-0.190000000000000,
-0.150000000000000,
-0.120000000000000,
-0.120000000000000,
-0.155000000000000,
-0.170000000000000,
-0.165000000000000,
-0.150000000000000,
-0.140000000000000,
-0.160000000000000,
-0.160000000000000,
-0.160000000000000,
-0.160000000000000,
-0.150000000000000,
-0.140000000000000,
-0.140000000000000,
-0.155000000000000,
-0.155000000000000,
-0.155000000000000,
-0.140000000000000,
-0.130000000000000,
-0.125000000000000,
-0.125000000000000,
-0.135000000000000,
-0.140000000000000,
-0.120000000000000,
-0.120000000000000,
-0.115000000000000,
-0.120000000000000,
-0.125000000000000,
-0.120000000000000,
-0.100000000000000,
-0.0900000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.105000000000000,
-0.120000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.105000000000000,
-0.125000000000000,
-0.110000000000000,
-0.105000000000000,
-0.0850000000000000,
-0.0950000000000000,
-0.0950000000000000,
-0.110000000000000,
-0.100000000000000,
-0.0900000000000000,
-0.0700000000000000,
-0.0700000000000000,
-0.0800000000000000,
-0.105000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.0500000000000000,
-0.0550000000000000,
-0.0600000000000000,
-0.0700000000000000,
-0.0800000000000000,
-0.0750000000000000,
-0.0450000000000000,
-0.0450000000000000,
-0.0600000000000000,
-0.0600000000000000,
-0.0550000000000000,
-0.0450000000000000,
-0.0500000000000000,
-0.0550000000000000,
-0.0550000000000000,
-0.0650000000000000,
-0.0650000000000000,
-0.0400000000000000,
-0.0450000000000000,
-0.0500000000000000,
-0.0700000000000000,
-0.0850000000000000,
-0.0750000000000000,
-0.0650000000000000,
-0.0650000000000000,
-0.0650000000000000,
-0.0800000000000000,
-0.100000000000000,
-0.0950000000000000,
-0.100000000000000,
-0.100000000000000,
-0.105000000000000,
-0.120000000000000,
-0.120000000000000,
-0.130000000000000,
-0.120000000000000,
-0.105000000000000,
-0.120000000000000,
-0.140000000000000,
-0.150000000000000,
-0.130000000000000,
-0.130000000000000,
-0.130000000000000,
-0.135000000000000,
-0.145000000000000,
-0.150000000000000,
-0.140000000000000,
-0.135000000000000,
-0.160000000000000,
-0.165000000000000,
-0.165000000000000,
-0.155000000000000,
-0.150000000000000,
-0.135000000000000,
-0.125000000000000,
-0.160000000000000,
-0.160000000000000,
-0.160000000000000,
-0.150000000000000,
-0.135000000000000,
-0.150000000000000,
-0.150000000000000,
-0.145000000000000,
-0.135000000000000,
-0.120000000000000,
-0.115000000000000,
-0.120000000000000]

yt = spfft.dct(y, norm='ortho')


plt.plot(y, color = "blue")

# extract small sample of signal
m = 512 # 10% sample
ri = np.random.choice(n, m, replace=False) # random sample of indices




ri.sort() # sorting not strictly necessary, but convenient for plotting
t2 = t[ri]
y2 = np.array(y)[ri]


# create idct matrix operator
A = spfft.idct(np.identity(n), norm='ortho', axis=0)
A = A[ri]

# do L1 optimization
vx = cvx.Variable(n)
objective = cvx.Minimize(cvx.norm(vx, 1))
constraints = [A*vx == y2]
prob = cvx.Problem(objective, constraints)
result = prob.solve(verbose=True)

# reconstruct signal
x = np.array(vx.value)
x = np.squeeze(x)
sig = spfft.idct(x, norm='ortho', axis=0)

plt.plot(sig, color = "red")
plt.plot(sig-y, color ="green")

plt.show()